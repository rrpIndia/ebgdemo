<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  /* Page layout for EVM */
body {
  margin: 0;
}

.evm {
  display: flex;
  flex-direction: column; /* mobile */
  align-items: center;
  gap: 16px;
}

.svg-vvpat-wrapper {
  margin-top: 24px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex: 0 0 auto;
}

.svg-vvpat {
  width: 200px;
  max-width: 90vw;
  display: block;
}
.svg-ballot-unit-wrapper {
  display: flex;
  justify-content: center; /* horizontal center */
  align-items: center;
  flex: 0 0 auto;
}

.svg-ballot-unit {
  width: 320px;      /* control size here */
  max-width: 95vw;
  display: block;
}

  </style>
</head>

<body>

<div class="evm">


	<div class="svg-vvpat-wrapper">	
  <!-- ================= VVPAT ================= -->
  <!-- VVPAT is placed FIRST so it appears on top on phones -->
  <svg
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 200 300"
    preserveAspectRatio="xMidYMin meet"
    class="svg-vvpat"
  >

    <!-- this is VVPAT Main Box-->
	<rect 
	  x="0" 
	  y="0" 
	  width="200" 
	  height="240" 
	  rx="6"
	  fill="gainsboro" 
	  stroke="#aaa"/>
		
    <!--this is vvpat screen from which voters see their vote slip-->
    <rect x="40" y="30"
	width="120" 
	height="80"
        fill="black"/>

    <g id="slip" opacity="0">
      <rect x="41" y="31"
	width="118"
	height="78"
        fill="#fff"/>
      <text id="slip-text"
	    x="100" y="75"
	    text-anchor="middle"
	    dominant-baseline="middle"
	
            font-size="42">
      </text>
    </g>

    <text x="100" y="230"
    text-anchor="middle"
    font-size="18">
MOCK VVPAT
    </text>

  </svg>
	</div>

<!-- ================= BALLOT UNIT ================= -->
<div class="svg-ballot-unit-wrapper">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 600 720"
    class="svg-ballot-unit"
  >

    <style>
      .BallotUnitBody {
        fill: gainsboro;
        stroke: #b5b5b5;
        stroke-width: 2;
      }
      .BallotUnitHeader {
        fill: lightgray;
        stroke: darkgray;
      }
      .BallotUnitNamePanel {
        fill: white;
        stroke: #ccc;
        rx: 8;
      }
      .BallotUnitButton {
        fill: #d9d9d9;
        stroke: #999;
        cursor: pointer;
      }
      .BallotUnitButton:active {
        transform: translateY(2px);
      }
      .led {
        fill: dimgray;
      }
      .led.on {
        fill: green;
        filter: drop-shadow(0 0 6px #00ff00);
      }
      #slip {
        transition: opacity 0.3s;
      }
    </style>

    <!-- EVM -->
    <g id="BallotUnit" transform="translate(130,10)">

      <!--This is main rectangle in which all buttons and candidates are -->
      <rect x="0" y="0" width="340" height="550" rx="18"
            class="BallotUnitBody"/>

      <!--this is rectangle which is head of ballot unit where text "DEMO VOTING MACHINE" is written.-->

      <rect x="10" y="10"
            width="320" height="60" rx="8"
            class="BallotUnitHeader"/>

      <!--
      [there is no way to center text inside a rectangle. svg has no parent child relationship.
       so Center of that rectangle must be calculated manually]

      Center X = 10 + (320 / 2) = 170
      Center Y = 10 + (60 / 2) = 40
      -->
      <text x="170" y="40"
            text-anchor="middle"
            dominant-baseline="middle"
	    font-size="24"
	    font-weight="bold"
            class="BallotUnitHeaderText">
        MOCK VOTING MACHINE
      </text>

      <!-- Candidates -->
      <g transform="translate(0,100)">

        <g>
          <rect x="20" y="0" width="220" height="44"
                class="BallotUnitNamePanel"/>
          <text x="30" y="28"
                font-size="24"
                font-weight="bold">
            Apple üçé
          </text>
          <circle id="led-1" cx="250" cy="22" r="6"
                  class="led"/>
          <rect x="270" y="4" width="60" height="36" rx="6"
                class="BallotUnitButton" onclick="vote(1)"/>
        </g>

        <g transform="translate(0,60)">
          <rect x="20" y="0" width="220" height="44"
                class="BallotUnitNamePanel"/>
          <text x="30" y="28"
                font-size="24"
                font-weight="bold">
            Banana üçå
          </text>
          <circle id="led-2" cx="250" cy="22" r="6"
                  class="led"/>
          <rect x="270" y="4" width="60" height="36" rx="6"
                class="BallotUnitButton" onclick="vote(2)"/>
        </g>

      </g>
    </g>

  </svg>
</div>

</div>

<script>
  let isLocked = false;
  let unlockTimer = null;
 function vote(n) {

  // ‚õî BLOCK if machine is locked
  if (isLocked) {
    console.log('Vote blocked: machine busy');
    return;
  }

  // üîí Lock immediately
  isLocked = true;

  // Clear any old unlock timer (safety)
  if (unlockTimer) {
    clearTimeout(unlockTimer);
  }

  // --------------------
  // NORMAL VOTE LOGIC
  // --------------------

  // Turn off all LEDs
  document.querySelectorAll('.led')
    .forEach(l => l.classList.remove('on'));

  // Turn ON selected LED
  const led = document.getElementById('led-' + n);
  led.classList.add('on');

  // Candidate mapping
  const candidates = {
    1: 'üçé',
    2: 'üçå'
  };

  // Update VVPAT slip
  document.getElementById('slip-text').textContent =
    candidates[n];

  const slip = document.getElementById('slip');
  slip.style.opacity = 1;

  // Hide slip after 3 seconds
  setTimeout(() => {
    slip.style.opacity = 0;
    led.classList.remove('on');
  }, 7000);

  // üîì UNLOCK AFTER 7 SECONDS (from LAST vote)
  unlockTimer = setTimeout(() => {
    isLocked = false;
    console.log('Machine unlocked, ready for next vote');
  }, 7000);
} 
</script>

</body>
</html>
